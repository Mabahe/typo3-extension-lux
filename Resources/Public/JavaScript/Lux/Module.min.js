define(["jquery"],function(e){"use strict";function t(e){var l=this,t=(this.initialize=function(){t("leadlistdetail","visitor"),t("companydetail","company"),t("analysiscontentdetailpage","page"),t("analysisnewsdetailpage","news"),t("analysisutmdetailpage","visitor"),t("analysissearchdetailpage","searchterm"),t("analysiscontentdetaildownload","download"),t("analysislinklistenerdetail","linkListener"),t("workflowdetail","workflow","luxenterprise"),t("abtestingdetail","abTesting","luxenterprise"),t("workflowurlshortenerdetail","urlShortener","luxenterprise"),n(),a(),i(),o(),r(),u(),c(),s(),d(),m(),g(),f()},function(t,n,a){a=a||"lux";for(var i=document.querySelectorAll("[data-lux-action-"+t+"]"),e=0;e<i.length;e++)i[e].addEventListener("click",function(){x(i,"lux-action-detail"),this.classList.add("lux-action-detail");var e={};e[n]=this.getAttribute("data-lux-action-"+t),v(TYPO3.settings.ajaxUrls["/"+a+"/"+t],e,"generalDetailCallback")})}),n=function(){var e=document.querySelector('[data-lux-container="detail"]');null!==e&&e.addEventListener("click",function(e){e=e.target;if(null!==e.getAttribute("data-lux-description")){e.classList.contains("lux-textarea__default")&&(e.classList.remove("lux-textarea__default"),e.value="");const[t,n]=e.getAttribute("data-lux-description").split(":");e.addEventListener("blur",function(){"visitor"===t&&v(TYPO3.settings.ajaxUrls["/lux/visitordescription"],{visitor:n,value:this.value},null),"company"===t&&v(TYPO3.settings.ajaxUrls["/lux/companydescription"],{company:n,value:this.value},null)})}})},a=function(){var t,e=document.querySelector("[data-lux-visitor-company]");null!==e&&(t=e.getAttribute("data-lux-visitor-company"),e.addEventListener("change",function(e){v(TYPO3.settings.ajaxUrls["/lux/visitorcompany"],{visitor:t,value:this.value},"reloadCallback")}))},i=function(){var t,e=document.querySelector("[data-lux-company-category]");null!==e&&(t=e.getAttribute("data-lux-company-category"),e.addEventListener("change",function(e){v(TYPO3.settings.ajaxUrls["/lux/companycategory"],{company:t,value:this.value})}))},o=(this.reloadCallback=function(e){location.reload()},function(){var e=document.querySelector('[data-lux-container="detail"]');null!==e&&e.addEventListener("click",function(e){var e=e.target;null!==e.getAttribute("data-lux-linkmock-event")&&(e=e.getAttribute("data-lux-linkmock-event"),null!==(e=document.querySelector('[data-lux-linkmock-link="'+e+'"]')))&&e.click()})}),r=(this.generalDetailCallback=function(e){document.querySelector('[data-lux-container="detail"]').innerHTML=e.html,u(),a(),i(),window.LuxDiagramObject.initialize()},function(){for(var e=document.querySelectorAll("[data-lux-confirm]"),t=0;t<e.length;t++)e[t].addEventListener("click",function(e){var t=e.currentTarget.getAttribute("data-lux-confirm");!1===confirm(t)&&e.preventDefault()})});const u=function(e){var t=(e=e||document).querySelectorAll("[data-lux-asynchronous-image],[data-lux-asynchronous-companyimage]");for(let e=0;e<t.length;e++){var n=t[e].getAttribute("data-lux-asynchronous-image"),n=(null!==n&&v(TYPO3.settings.ajaxUrls["/lux/visitorimage"],{visitor:n},"asynchronousImageLoadingCallback",{element:t[e]}),t[e].getAttribute("data-lux-asynchronous-companyimage"));null!==n&&v(TYPO3.settings.ajaxUrls["/lux/companyimage"],{company:n},"asynchronousImageLoadingCallback",{element:t[e]})}},c=(this.asynchronousImageLoadingCallback=function(e,t){t.element instanceof HTMLImageElement&&t.element.setAttribute("src",e.url)},function(){document.querySelectorAll("[data-lux-getlinklistenerperformance]").forEach(function(e){var t=e.getAttribute("data-lux-getlinklistenerperformance");0<t&&v(TYPO3.settings.ajaxUrls["/lux/linklistenerperformance"],{linkListener:t},"asynchronousLinkListenerPerformanceLoadingCallback",{element:e})})}),s=(this.asynchronousLinkListenerPerformanceLoadingCallback=function(e,t){e=(100*e.performance).toFixed(1);t.element.innerHTML=e+" %"},function(){document.querySelectorAll("[data-lux-getcompaniesinformation-numberofvisits]").forEach(function(e){var t=e.getAttribute("data-lux-getcompaniesinformation-numberofvisits");0<t&&v(TYPO3.settings.ajaxUrls["/lux/companiesinformation"],{company:t},"asynchronousCompaniesInformationLoadingCallback",{element:e})})}),d=(this.asynchronousCompaniesInformationLoadingCallback=function(e,t){t=t.element;t.innerHTML=e.numberOfVisits,t.closest("tr").querySelector("[data-lux-getcompaniesinformation-numberofvisitors]").innerHTML=e.numberOfVisitors},function(){var e=document.querySelector('[data-lux-getoverallleads="source"]'),t=document.querySelector('[data-lux-getoverallleads="target"]');null!==e&&null!==t&&v(TYPO3.settings.ajaxUrls["/lux/overallleads"],{},"asynchronousAnythingAmountLoadingCallback",{elementSource:e,elementTarget:t})}),m=function(){var e=document.querySelector('[data-lux-getoverallcompanies="source"]'),t=document.querySelector('[data-lux-getoverallcompanies="target"]');null!==e&&null!==t&&v(TYPO3.settings.ajaxUrls["/lux/overallcompanies"],{},"asynchronousAnythingAmountLoadingCallback",{elementSource:e,elementTarget:t})},g=(this.asynchronousAnythingAmountLoadingCallback=function(e,t){t.elementSource.innerHTML<e.amount&&(t.elementTarget.innerHTML=e.amountLabel)},function(){document.querySelectorAll("[data-lux-action-toggleaction]").forEach(function(e){e.addEventListener("click",function(e){e=e.currentTarget.getAttribute("data-lux-action-toggleaction");document.querySelectorAll('[data-lux-action-togglecontainer="'+e+'"]').forEach(function(e){e.classList.toggle("hidden")})})})}),f=function(){document.querySelectorAll("[data-lux-unitajax]").forEach(function(n){var e,t=new URLSearchParams;for(e in t.append("path",n.getAttribute("data-lux-unitajax")),n.dataset)0===e.indexOf("luxUnitajaxParameter")&&t.append("arguments["+e.substring("luxUnitajaxParameter".length).toLowerCase()+"]",n.dataset[e]);fetch(TYPO3.settings.ajaxUrls["/lux/unitajax"]+"&"+t).then(e=>e.text()).then(function(e){var t=n.parentNode;t.innerHTML=e,window.LuxDiagramObject.initialize(t),null!==t.querySelector("[data-lux-toggle]")&&LuxPageOverviewObject.initialize(t),u(t)}).catch(function(e){console.log(e)})})};var x=function(e,t){for(var n=0;n<e.length;n++)e[n].classList.remove(t)},v=function(e,t,n,a){var i;a=a||{},void 0!==e&&""!==e?((i=new XMLHttpRequest).onreadystatechange=function(){4===this.readyState&&200===this.status&&null!==n&&l[n](JSON.parse(this.responseText),a)},i.open("POST",y(e,t),!0),i.send()):console.log("No ajax URI given!")},y=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(-1!==e.indexOf("?")?e+="&":e+="?",e+=n+"="+encodeURIComponent(t[n]));return e}}e(document).ready(function(){(new t).initialize()})});